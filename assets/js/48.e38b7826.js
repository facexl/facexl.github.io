(window.webpackJsonp=window.webpackJsonp||[]).push([[48],{337:function(t,s,a){"use strict";a.r(s);var e=a(14),r=Object(e.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h2",{attrs:{id:"记一次编译错误"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#记一次编译错误"}},[t._v("#")]),t._v(" 记一次编译错误")]),t._v(" "),s("p",[t._v("今天下午拉了一个老项目，"),s("code",[t._v("npm install")]),t._v("完毕后，却 run 不起来，控制台报错:\n"),s("img",{attrs:{src:"http://img.xlcool.cn/WX20200629-223909%402x.png",alt:""}}),t._v("\n由于平时编译错误基本会精确到哪部分代码有问题，或者是xx依赖版本不合适。这次的却并不是很明显。我一来就先入为主，")]),t._v(" "),s("ul",[s("li",[t._v("首先直接认为是"),s("code",[t._v("vue")]),t._v("版本和"),s("code",[t._v("vue-template-compiler")]),t._v("版本对不上号导致的。于是查看了这俩依赖版本，发现是一样的"),s("code",[t._v("2.5.17")]),t._v("。")]),t._v(" "),s("li",[t._v("随后又觉得是版本低了，于是同时升级了到了2.6.0。结果还是编译失败，14个文件有相同错误。")]),t._v(" "),s("li",[t._v("然后又觉得是"),s("code",[t._v("npm")]),t._v("缓存，于是"),s("code",[t._v("npm cache clean -f")]),t._v("，结果依然无效。"),s("br"),t._v(" "),s("code",[t._v("经过一系列无效无根据的尝试，问题没能解决，完全是小鹿乱撞。浪费了精力和时间")]),t._v("。喝了一杯凉水后，重新审视控制台错误，发现一眼看上去报错不明显，但其实整个错误栈是明明白白在那儿的。\n虽然有14个文件报错，但都是相同错误，想过找14个文件相同点，但那样不够精准，难以定位。于是仔细看了每一批错误的堆栈。发现具体报错的代码行数总是在这个组件的最后一行。")])]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("Export\n    "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("isNew"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"true"')]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("query"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v('"'),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("query"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v('"\n    '),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("exportOptions"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"exportOptions"')]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("url"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"$api.user.storeApply.export"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n")])])]),s("p",[t._v("我先尝试注释了一个文件的这个组件，然后编译错误就少了一个。于是问题越来越清晰。最终定位到模板里的展开运算符(点点点)会导致编译失败。\n随后注意到了错误堆栈反复出现的"),s("code",[t._v("vue-template-es2015-compiler")]),t._v("。经查询是专门为了 vue 模板语法支持新的"),s("code",[t._v("es6")]),t._v("特性。于是问题差不多明朗了，\n手动升级"),s("code",[t._v("vue-template-es2015-compiler")]),t._v("从1.6到1.9.1。编译通过。")]),t._v(" "),s("h3",{attrs:{id:"总结"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#总结"}},[t._v("#")]),t._v(" 总结")]),t._v(" "),s("p",[t._v("有时候我们面对平时没有遇到过的问题，往往手忙脚乱，胡思乱想，很难意识到冷静分析才能快速解决问题。以后要时刻提醒自己：\n"),s("code",[t._v("解决问题的最好办法是直视问题，而不是投机取巧")])])])}),[],!1,null,null,null);s.default=r.exports}}]);