import"./index-c2ae2a0e.js";import{d as e}from"./dtool-b3945d0c.js";const t=[{title:"成本价",prop:"cost_price",hidden:!1},{title:"会员价",prop:"shop_price",vilidateProp:"shop_price_vilidate",hidden:!1},{title:"桔掌柜价",prop:"store_price",vilidateProp:"store_price_vilidate",hidden:!1},{title:"优秀桔掌柜价",prop:"partner_price",vilidateProp:"partner_price_vilidate",hidden:!1},{title:"库存",prop:"stock_num",hidden:!1,isStock:!0}],r=t;t.filter((e=>e.vilidateProp)).map((e=>e.prop)),t.filter((e=>"stock"!==e.prop));const i=function(){return{...t.reduce(((e,t)=>(e[t.vilidateProp]=!1,e)),{}),showDom:!1}},s=()=>t.reduce(((e,t)=>(e[t.prop]=null,e)),{}),a=e=>{const{attr:t,sku_imgs:r}=e.goods,{sku_data:s}=e;let a=[];const _=o(t);s.length&&s.forEach(((e,t)=>{const r=e.properties.split(/,|:/).filter(((e,t)=>t%2!=0));a.push(r),e.combination_tag=r.sort(((e,t)=>+e-Number(t))).join(","),e.properties_name&&e.properties_name.length&&Object.assign(e,e.properties.split(",").reduce(((e,t)=>{const r=t.split(":");return e[r[0]]=_[r[1]]?_[r[1]].value:"",e}),{}),i())}));const p=a.flat();return t.forEach((e=>{e.attr_item_choosed=[],e.values.forEach((t=>{p.includes(t.id.toString())&&e.attr_item_choosed.push(t.id)}))})),{attr:t,sku_data:s,sku_imgs:Object.keys(r).map((e=>({id:e,url:r[e]})))}},o=e=>{if(!e.length)return{};let t=[];return e.forEach(((e,r)=>{e.values.forEach((i=>{i.$pid=e.id,i.$pname=e.name,i.$weights=r,t.push(i)}))})),t.reduce(((e,t)=>(e[t.id]=t,e)),{})},_=e=>e.length?e.reduce(((e,t)=>(e[t.id]=t.name,e)),{}):{},p=["sort","order_integral","first_integral","second_integral","single_max","single_min","day_max","limit_max","zu_num","receiver_city_code","receiver_district_code","receiver_province_code","freight_id","insurance_id","supplier_id"],c=(t,r)=>{e(r).split(["label_ids","service_ids","member_type","platform","key_phrase","convert_coupon_ids"]).stringArrToNumber(["member_type","platform","label_ids","service_ids","convert_coupon_ids"]).avoid0(p).combinDayjs(["start_at","end_at"]).combinDayjs(["group_start_at","group_end_at"]).arrToUrlArr(["imgs"]).urlWrap(["video"]).insertForm(t),t.key_phrase=t.key_phrase.concat(["","",""]).slice(0,3),t.cat_ids=[r.cat_id1,r.cat_id2,r.cat_id3].filter((e=>!!e))},n=(t,r)=>e(t).filter(["key_phrase"]).join(["label_ids","service_ids","member_type","platform","key_phrase","del_attr_ids","del_attr_value_ids","convert_coupon_ids"]).splitDayjs(["start_at","end_at"],"YYYY-MM-DD HH:mm:ss").splitDayjs(["group_start_at","group_end_at"],"YYYY-MM-DD HH:mm:ss").toNumber(p).toNumber(["store_first_fee","order_integral","store_second_fee","first_integral","partner_first_fee","second_integral"]).urlArrToArr(["imgs"]).urlUnWrap(["video"]).toString(["receiver_phone"]).custom((e=>{e.sku_imgs=e.sku_imgs.filter((e=>e.url)).reduce(((e,t)=>(e[t.id]=t.url,e)),{});const t=e.cat_ids.concat([0,0,0]);e.cat_id1=t[0],e.cat_id2=t[1],e.cat_id3=t[2],e.thumb=e.imgs[0],r&&l(e)})).toJSON(["param","sku_data","sku_imgs","imgs","detail_video","attr"]).del(["start_at-end_at","cat_ids","group_start_at-group_end_at"]).end(),d=(e,t)=>{const r=o(t);return e.forEach((e=>{e.combination_tag=((e,t)=>t.split(",").sort(((t,r)=>(console.log(t,r,e[t].$weights,e[r].$weights,12324),e[t].$weights-e[r].$weights))).join(","))(r,e.combination_tag)})),e.map((e=>({atv_ids:e.combination_tag,shop_price:e.shop_price,store_price:e.store_price,partner_price:e.partner_price,cost_price:e.cost_price,stock_num:e.stock_num,id:e.id||0})))},l=e=>{const t=e.shop_price;Object.assign(e,{market_price:t,store_price:t,partner_price:t}),e.sku_data.forEach((e=>{e.shop_price=t,e.store_price=t,e.partner_price=t,e.cost_price=t}))};export{r as B,t as D,_ as a,s as b,i as c,n as d,o as g,a as i,d as s,c as t};
