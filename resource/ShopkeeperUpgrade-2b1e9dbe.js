import{d as e,i as a,r as t,m as l,o as s,l as n,a as o,b as r,e as i,w as d,f as u,k as c,$ as m,M as p,A as _,a7 as h,E as k,a3 as g,a4 as v,g as f,_ as b,q as w,I as y,G as x,H as U,x as j,p as C,B as q,s as D,F as I,z as S}from"./index-c2ae2a0e.js";import{u as R,_ as B}from"./useTableColumns-dd067b4d.js";import{R as F,_ as N}from"./index-c8577ae4.js";import"./index-3f0a4d2e.js";import{_ as O}from"./index-00d344de.js";import{_ as T}from"./index-ef11d20c.js";import{u as $,a as z}from"./useSearchItems-c7d75cf3.js";import{u as E}from"./usePagination-c05046ed.js";import{_ as A}from"./index-8036da2a.js";import{d as G}from"./index-a09a23de.js";import"./FolderOpenOutlined-fa174baf.js";import"./tool-d986b095.js";import"./RadioButton-bc4165ed.js";const H=e=>(g("data-v-87f83758"),e=e(),v(),e),K=H((()=>f("div",{style:{display:"inline-block","vertical-align":"middle","margin-top":"5px","margin-right":"5px"}}," 最近 ",-1))),M=H((()=>f("div",{style:{display:"inline-block","vertical-align":"middle",margin:"5px 5px 0 5px"}}," 团队订单≥ ",-1))),P=b(e({__name:"UpgradeTaskSet",props:{show:Boolean,id:Number},emits:["fresh"],setup(e,{emit:g}){const v=a(e,"show",g),f=t(),b={required:!0,message:"请输入"},w=l({loading:!1}),y=l({member_num:void 0,last_month_num:void 0,team_order_num:void 0,remark:void 0});s((()=>{})),n(v,(e=>{e&&(f.value&&f.value.resetFields(),w.loading=!0,m.user.upgrade.detail({}).then((e=>{for(let a in y)void 0!==e.data[a]&&(y[a]=e.data[a]);setTimeout((e=>{w.loading=!1}),50)})))}));const x=()=>{f.value.validate().then((async e=>{await m.user.upgrade.edit({...e}),v.value=!1,g("fresh")})).catch((e=>{console.log(e)}))};return(e,a)=>{const t=A,l=_,s=h,n=k,m=p;return o(),r("div",null,[i(m,{visible:u(v),"onUpdate:visible":a[4]||(a[4]=e=>c(v)?v.value=e:null),width:"600px",title:"任务配置","mask-closable":!1,onOk:x},{default:d((()=>[i(n,{ref_key:"formRef",ref:f,model:u(y),autocomplete:"off","label-col":{span:5},"wrapper-col":{span:19}},{default:d((()=>[i(l,{name:"member_num",label:"团队人数≥",rules:[b]},{default:d((()=>[i(t,{value:u(y).member_num,"onUpdate:value":a[0]||(a[0]=e=>u(y).member_num=e),"addon-after":"人",style:{width:"200px"}},null,8,["value"])])),_:1},8,["rules"]),i(l,{name:"last_month_num",label:"订单",rules:[b],"label-col":{},style:{float:"left","margin-left":"62px"}},{default:d((()=>[K,i(t,{value:u(y).last_month_num,"onUpdate:value":a[1]||(a[1]=e=>u(y).last_month_num=e),"addon-after":"月",style:{width:"140px"}},null,8,["value"])])),_:1},8,["rules"]),i(l,{name:"team_order_num",colon:!1,rules:[b],"wrapper-col":{}},{default:d((()=>[M,i(t,{value:u(y).team_order_num,"onUpdate:value":a[2]||(a[2]=e=>u(y).team_order_num=e),"addon-after":"单",style:{width:"140px"}},null,8,["value"])])),_:1},8,["rules"]),i(l,{name:"remark",label:"提示"},{default:d((()=>[i(s,{value:u(y).remark,"onUpdate:value":a[3]||(a[3]=e=>u(y).remark=e),style:{height:"100px"},maxlength:100,"show-count":""},null,8,["value"])])),_:1})])),_:1},8,["model"])])),_:1},8,["visible"])])}}}),[["__scopeId","data-v-87f83758"]]),J=(e=>(g("data-v-8f340140"),e=e(),v(),e))((()=>f("div",null,"是否同意用户升级未优秀桔掌柜？",-1))),L=b(e({__name:"UpgradeCheck",props:{show:Boolean,id:Number},emits:["fresh"],setup(e,{emit:h}){const g=e,v=a(g,"show",h),f=t(),b={required:!0,message:"请输入"};l({loading:!1});const x=l({check_status:1,check_remark:void 0});s((()=>{})),n(v,(e=>{e&&f.value&&f.value.resetFields()}));const U=()=>{f.value.validate().then((async e=>{await m.user.upgrade.check({...e,id:g.id||void 0}),v.value=!1,h("fresh")})).catch((e=>{console.log(e)}))};return(e,a)=>{const t=_,l=F,s=N,n=y,m=k,h=p;return o(),r("div",null,[i(h,{visible:u(v),"onUpdate:visible":a[2]||(a[2]=e=>c(v)?v.value=e:null),width:"600px",title:"审核","mask-closable":!1,onOk:U},{default:d((()=>[i(m,{ref_key:"formRef",ref:f,model:u(x),autocomplete:"off","label-col":{span:4},"wrapper-col":{span:19}},{default:d((()=>[i(t,{colon:!1,label:" "},{default:d((()=>[J])),_:1}),i(t,{name:"check_status",colon:!1,label:" "},{default:d((()=>[i(s,{value:u(x).check_status,"onUpdate:value":a[0]||(a[0]=e=>u(x).check_status=e)},{default:d((()=>[i(l,{value:1},{default:d((()=>[w(" 同意 ")])),_:1}),i(l,{value:2},{default:d((()=>[w(" 不同意 ")])),_:1})])),_:1},8,["value"])])),_:1}),i(t,{name:"check_remark",colon:!1,label:" ",rules:2==+u(x).check_status?[b]:[]},{default:d((()=>[i(n,{value:u(x).check_remark,"onUpdate:value":a[1]||(a[1]=e=>u(x).check_remark=e),maxlength:20,placeholder:"审核备注(不同意时必填)","show-count":""},null,8,["value"])])),_:1},8,["rules"])])),_:1},8,["model"])])),_:1},8,["visible"])])}}}),[["__scopeId","data-v-8f340140"]]),Q=f("div",{style:{display:"inline-block",color:"#999"}}," 升级任务开关 ",-1),V={key:2},W=e({__name:"ShopkeeperUpgrade",setup(e){const a={0:"待处理",1:"已通过",2:"已拒绝"},t=$([["input","uid","用户ID"],["input","username","用户昵称"],["dateRange","apply_start-apply_end",["申请时间","结束时间"]],["dateRange","check_start-check_end",["审核时间","结束时间"]],["select","check_status","审核状态"]]);z(t,"check_status",a);const n=R([["用户ID","uid"],["用户头像","useravatar"],["用户昵称","username"],["团队人数","team_member_num"],["团队订单","team_order_num"],["申请时间","apply_time"],["审核时间","check_time"],["审核状态","check_status"],["审核备注","check_remark"],["操作","operate",200,"right"]]),c=l({handlingId:0,dataSource:[],loading:!1,query:{},pagination:E(),showNewDialog:!1,showCheckDialog:!1,handlingInfo:{},selectedRowKeys:[],selectBtn:void 0,task_enabled:0});s((()=>{p()}));const p=()=>{c.loading=!0,m.user.upgrade.list({page:c.pagination.current,page_size:c.pagination.pageSize,...c.query}).then((e=>{var a;c.loading=!1,c.dataSource=e.data.items,1===c.pagination.current&&(c.pagination.total=+(null==(a=e.data)?void 0:a.count)),c.task_enabled=e.data.task_enabled}))},_=e=>{c.pagination={...c.pagination,...e},p()},h=e=>{c.query=e,c.pagination={...c.pagination,current:1},p()};return(e,l)=>{const s=x("Export"),k=x("Search"),g=T,v=q,b=O,y=B,R=U("permission");return o(),r("div",null,[i(k,{"search-options":u(t),onOnSearch:h},{default:d((()=>[j(i(s,{api:u(m).user.upgrade.export,query:{...u(c).query}},null,8,["api","query"]),[[R,[u(m).user.upgrade.export]]])])),_:1},8,["search-options"]),f("div",null,[Q,i(g,{checked:u(c).task_enabled,"onUpdate:checked":l[0]||(l[0]=e=>u(c).task_enabled=e),"un-checked-value":0,"checked-value":1,style:{"margin-right":"20px","margin-left":"5px"},onChange:l[1]||(l[1]=e=>{G.confirm({title:"任务开关",content:`${c.task_enabled?"开启":"关闭"}任务情况下，用户${c.task_enabled?"可见":"不可见"}该任务卡片。确认${c.task_enabled?"开启":"关闭"}任务？`,okText:"确认",cancelText:"取消",onOk:async()=>{await m.user.upgrade.status({enabled:c.task_enabled}).catch((e=>{c.task_enabled=1===c.task_enabled?0:1})),p()},onCancel(){c.task_enabled=1===c.task_enabled?0:1}})})},null,8,["checked"]),j((o(),C(v,{type:"primary",onClick:l[2]||(l[2]=e=>u(c).showNewDialog=!0)},{default:d((()=>[w(" 任务配置 ")])),_:1})),[[R,[u(m).user.upgrade.edit]]])]),i(y,{"data-source":u(c).dataSource,columns:u(n),scroll:{x:"max-content"},loading:u(c).loading,pagination:u(c).pagination,"row-key":"id",onChange:_},{bodyCell:d((({column:e,record:t})=>["useravatar"===e.key?(o(),C(b,{key:0,width:50,src:t.useravatar},null,8,["src"])):D("",!0),"check_status"===e.key?(o(),r(I,{key:1},[w(S(a[t.check_status+""]),1)],64)):D("",!0),"operate"===e.key?(o(),r("div",V,[i(v,{type:"link",disabled:1==+t.check_status||2==+t.check_status,onClick:e=>{u(c).handlingId=t.id,u(c).showCheckDialog=!0}},{default:d((()=>[w(" 审核 ")])),_:2},1032,["disabled","onClick"])])):D("",!0)])),_:1},8,["data-source","columns","loading","pagination"]),i(P,{show:u(c).showNewDialog,"onUpdate:show":l[3]||(l[3]=e=>u(c).showNewDialog=e),onFresh:p},null,8,["show"]),i(L,{id:u(c).handlingId,show:u(c).showCheckDialog,"onUpdate:show":l[4]||(l[4]=e=>u(c).showCheckDialog=e),onFresh:p},null,8,["id","show"])])}}});export{W as default};
