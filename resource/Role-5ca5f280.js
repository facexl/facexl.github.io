import{d as a,i as e,r as o,l as n,m as l,cJ as i,a as t,p as s,w as r,f as d,k as u,$ as c,M as m,e as p,I as g,A as h,E as v,o as f,G as k,b as w,K as y,q as C,s as _,B as b,a3 as D,a4 as j,g as R,_ as x}from"./index-c2ae2a0e.js";import{u as O,_ as S}from"./useTableColumns-dd067b4d.js";import"./index-c8577ae4.js";import"./index-3f0a4d2e.js";import{u as q}from"./useSearchItems-c7d75cf3.js";import{u as M}from"./usePagination-c05046ed.js";import"./FolderOpenOutlined-fa174baf.js";import"./tool-d986b095.js";import"./RadioButton-bc4165ed.js";const U=a({__name:"RoleModal",props:{show:Boolean,content:Object},emits:["fresh","update:show"],setup(a,{emit:f}){const k=a,w=e(k,"show",f),y=o();n(w,(a=>{var e,o,n;a&&(y.value&&y.value.resetFields(),_.id=(null==(e=null==k?void 0:k.content)?void 0:e.id)??"",_.name=(null==(o=null==k?void 0:k.content)?void 0:o.name)??"",_.remark=(null==(n=null==k?void 0:k.content)?void 0:n.remark)??"")}));const C=l({loading:!1}),_=l({id:"",name:"",remark:""}),b=i((async()=>{try{await y.value.validate(),C.loading=!0;const{id:a,name:e,remark:o}=_;a?await c.jurisdiction.editRole({id:a,name:e,remark:o}):await c.jurisdiction.createRole({name:e,remark:o}),w.value=!1,f("fresh")}catch(a){}finally{C.loading=!1}}),1e3,!1);return(a,e)=>{var o;const n=g,l=h,i=v,c=m;return t(),s(c,{visible:d(w),"onUpdate:visible":e[2]||(e[2]=a=>u(w)?w.value=a:null),width:"400px",title:(null==(o=d(_))?void 0:o.id)?"编辑角色":"添加角色","confirm-loading":d(C).loading,"destroy-on-close":"",onOk:d(b)},{default:r((()=>[p(i,{ref_key:"formRef",ref:y,model:d(_),autocomplete:"off","label-col":{span:6},"wrapper-col":{span:18}},{default:r((()=>[p(l,{name:"name",label:"角色名称",rules:[{required:!0,message:"请输入角色名称"}]},{default:r((()=>[p(n,{value:d(_).name,"onUpdate:value":e[0]||(e[0]=a=>d(_).name=a),placeholder:"请输入角色名称"},null,8,["value"])])),_:1}),p(l,{name:"remark",label:"角色描述",rules:[{required:!1,message:"请输入角色描述"}]},{default:r((()=>[p(n,{value:d(_).remark,"onUpdate:value":e[1]||(e[1]=a=>d(_).remark=a),placeholder:"请输入角色描述"},null,8,["value"])])),_:1})])),_:1},8,["model"])])),_:1},8,["visible","title","confirm-loading","onOk"])}}}),B={key:0},F=(a=>(D("data-v-724b5b0e"),a=a(),j(),a))((()=>R("p",null,"确认删除？",-1))),I=x(a({__name:"Role",setup(a){const e=q([["input","name_like","请输入角色名称"]]),o=O([["角色名称","name"],["角色描述","remark"],["操作","operate",250,"right"]]),n=l({dataSource:[],loading:!1,query:{},pagination:M(),showRoleMadalDialog:!1,handlingContent:{},showDelConfirmDialog:!1});f((()=>{u()}));const s=a=>{n.query=a,n.pagination={...n.pagination,current:1},u()},u=async()=>{try{n.handlingContent={},n.loading=!0;const{data:a}=await c.jurisdiction.getRoleList({page:n.pagination.current,page_size:n.pagination.pageSize,...n.query});n.loading=!1,n.dataSource=(null==a?void 0:a.items)??[],n.pagination.total=+((null==a?void 0:a.count)??0)}catch(a){}},g=a=>{n.pagination=a,u()},h=i((async()=>{var a;try{n.loading=!0;const{data:e}=await c.jurisdiction.delRole({id:(null==(a=null==n?void 0:n.handlingContent)?void 0:a.id)??""});n.showDelConfirmDialog=!1,u()}catch(e){}finally{n.loading=!1}}),1e3,!1);return(a,l)=>{var i;const c=b,v=k("Search"),f=S,D=m;return t(),w("div",null,[p(v,{"search-options":d(e),onOnSearch:s},{default:r((()=>[p(c,{class:"add-btn",type:"primary",onClick:l[0]||(l[0]=y((a=>{d(n).handlingContent={},d(n).showRoleMadalDialog=!0}),["stop"]))},{default:r((()=>[C(" 添加 ")])),_:1})])),_:1},8,["search-options"]),p(f,{"data-source":d(n).dataSource,columns:d(o),bordered:"",scroll:{y:1e3},loading:d(n).loading,pagination:d(n).pagination,onChange:g},{bodyCell:r((({column:e,record:o})=>["operate"===e.key?(t(),w("div",B,[p(c,{type:"link",onClick:y((e=>a.$router.push({name:"RolePermissionsSet",params:{id:o.id}})),["stop"])},{default:r((()=>[C(" 权限设置 ")])),_:2},1032,["onClick"]),p(c,{type:"link",onClick:y((a=>{d(n).handlingContent=o,d(n).showRoleMadalDialog=!0}),["stop"])},{default:r((()=>[C(" 编辑 ")])),_:2},1032,["onClick"]),p(c,{type:"link",onClick:y((a=>{d(n).handlingContent=o,d(n).showDelConfirmDialog=!0}),["stop"])},{default:r((()=>[C(" 删除 ")])),_:2},1032,["onClick"])])):_("",!0)])),_:1},8,["data-source","columns","loading","pagination"]),p(U,{show:d(n).showRoleMadalDialog,"onUpdate:show":l[1]||(l[1]=a=>d(n).showRoleMadalDialog=a),content:(null==(i=d(n))?void 0:i.handlingContent)??{},onFresh:l[2]||(l[2]=a=>{d(n).handlingContent={},u()})},null,8,["show","content"]),p(D,{visible:d(n).showDelConfirmDialog,"onUpdate:visible":l[3]||(l[3]=a=>d(n).showDelConfirmDialog=a),width:"400px",title:"提示","cancel-text":"关闭","ok-text":"删除","ok-type":"danger","confirm-loading":d(n).loading,onOk:d(h)},{default:r((()=>[F])),_:1},8,["visible","confirm-loading","onOk"])])}}}),[["__scopeId","data-v-724b5b0e"]]);export{I as default};
