import{d as e,r as a,i as l,l as t,m as i,a as n,b as o,e as s,w as d,f as r,k as u,$ as p,M as c,g as _,A as g,C as h,D as m,E as f,S as k,F as y,n as v,q as w,z as b,o as x,G as j,H as S,s as C,p as P,x as R,B as U}from"./index-c2ae2a0e.js";import{u as q,_ as D}from"./useTableColumns-dd067b4d.js";import"./index-c8577ae4.js";import"./index-3f0a4d2e.js";import{_ as I}from"./index-ef11d20c.js";import{u as F}from"./usePagination-c05046ed.js";import{_ as M}from"./index-8036da2a.js";import{d as T}from"./dtool-b3945d0c.js";import{_ as B}from"./index-975d3375.js";import{_ as K}from"./index-00d344de.js";import{C as O}from"./index-1dfc023a.js";import{D as z,_ as A}from"./index-923a8554.js";import{_ as E}from"./Transport.vue_vue_type_script_setup_true_lang-724b9997.js";import"./FolderOpenOutlined-fa174baf.js";import"./tool-d986b095.js";import"./RadioButton-bc4165ed.js";import"./index-b1df7cdb.js";const G=_("span",null,"千克",-1),H=e({__name:"PickMod",props:{show:Boolean,id:String},emits:["fresh"],setup(e,{emit:_}){const y=e,v=a(),w=l(y,"show",_);t(w,(async e=>{if(v.value&&v.value.resetFields(),y.id&&e){b.loading=!0;const e=await p.afterSale.pick.detail({id:y.id});b.loading=!1,T(e.data.pick).insertForm(x)}}));const b=i({loading:!1}),x=i({weight:"",total_fee:"",deduct_fee:""}),j=()=>{v.value.validate().then((async e=>{b.loading=!0;try{await p.afterSale.pick.mod({...x,id:y.id}),b.loading=!1,w.value=!1,_("fresh")}catch(a){b.loading=!1}}))};return(e,a)=>{const l=M,t=g,i=h,p=m,_=f,y=k,S=c;return n(),o("div",null,[s(S,{visible:r(w),"onUpdate:visible":a[4]||(a[4]=e=>u(w)?w.value=e:null),width:"650px",title:"修改运费",onOk:j},{default:d((()=>[s(y,{spinning:r(b).loading,"onUpdate:spinning":a[3]||(a[3]=e=>r(b).loading=e)},{default:d((()=>[s(_,{ref_key:"formRef",ref:v,model:r(x),"label-col":{span:6},"wrapper-col":{span:18}},{default:d((()=>[s(p,null,{default:d((()=>[s(i,{span:18},{default:d((()=>[s(t,{name:"weight",label:"商品重量",required:""},{default:d((()=>[s(l,{value:r(x).weight,"onUpdate:value":a[0]||(a[0]=e=>r(x).weight=e),min:0},{addonAfter:d((()=>[G])),_:1},8,["value"])])),_:1}),s(t,{name:"total_fee",label:"上门取件费用",required:""},{default:d((()=>[s(l,{value:r(x).total_fee,"onUpdate:value":a[1]||(a[1]=e=>r(x).total_fee=e),style:{width:"68%"},min:0},null,8,["value"])])),_:1}),s(t,{name:"deduct_fee",label:"系统抵扣费用"},{default:d((()=>[s(l,{value:r(x).deduct_fee,"onUpdate:value":a[2]||(a[2]=e=>r(x).deduct_fee=e),style:{width:"68%"},min:0},null,8,["value"])])),_:1})])),_:1})])),_:1})])),_:1},8,["model"])])),_:1},8,["spinning"])])),_:1},8,["visible"])])}}}),J={class:"left"},L={class:"right"},N={class:"title"},W={class:"sku"},$=e({__name:"PickDetail",props:{show:Boolean,id:Number},emits:[],setup(e,{emit:c}){const g=e,h=l(g,"show",c),m=[["上门取件流水号","pick_sn"],["申请时间","created_at"],["状态","status_name"],["更新时间","updated_at"],["售后类型","sale_type_name"],["售后单号","sale_sn"],["订单号","order_sn"],["京东运单号","waybill_code"],["下单人ID","uid"]],f=[["物流公司","logistics_name"],["物流单号","logistics_sn"],["取件码","pick_code"],["取件人","picker_name"],["联系人电话","picker_tel"]],x=[["联系人","deliver_name"],["联系电话","deliver_phone"],["联系地址","deliver_full_address"]],j=[["联系人","receiver_name"],["联系电话","receiver_phone"],["联系地址","receiver_full_address"]],S=q([["上门取件费用","total_fee"],["退换省心服务抵扣","deduct_fee"],["应付金额","actual_fee"],["实付金额","pay_fee"],["支付流水号","pay_sn"]]),C=i({loading:!1}),P=a({}),R=a({});return t(h,(e=>{e&&(C.loading=!0,p.afterSale.pick.detail({id:g.id}).then((e=>{P.value=e.data.goods,R.value=e.data.pick,C.loading=!1})))})),(e,a)=>{const l=z,t=A,i=O,p=K,c=D,g=k,U=B;return n(),o("div",null,[s(U,{visible:r(h),"onUpdate:visible":a[0]||(a[0]=e=>u(h)?h.value=e:null),title:"详情",placement:"right",width:"80%"},{default:d((()=>[s(g,{spinning:r(C).loading},{default:d((()=>[s(i,{title:"基本信息"},{default:d((()=>[s(t,null,{default:d((()=>[(n(),o(y,null,v(m,((e,a)=>s(l,{key:a,label:e[0]},{default:d((()=>[w(b(r(R)[e[1]]),1)])),_:2},1032,["label"]))),64))])),_:1})])),_:1}),s(i,{title:"取件信息",style:{"margin-top":"8px"}},{default:d((()=>[s(t,{column:1,"content-style":{flexWrap:"wrap"}},{default:d((()=>[s(l,{label:"商品信息"},{default:d((()=>[(n(!0),o(y,null,v(r(P),(e=>(n(),o("div",{key:e.id,class:"flex"},[_("div",J,[s(p,{width:70,src:e.goods_thumb},null,8,["src"])]),_("div",L,[_("div",N,b(e.goods_title),1),_("div",W,b(e.sku_name),1)])])))),128))])),_:1}),s(l,{label:"商品重量"},{default:d((()=>[w(b(r(R).weight),1)])),_:1})])),_:1})])),_:1}),s(i,{title:"快递信息",style:{"margin-top":"8px"}},{default:d((()=>[s(t,null,{default:d((()=>[(n(),o(y,null,v(f,((e,a)=>s(l,{key:a,label:e[0]},{default:d((()=>[w(b(r(R)[e[1]]),1)])),_:2},1032,["label"]))),64))])),_:1})])),_:1}),s(i,{title:"地址信息",style:{"margin-top":"8px"}},{default:d((()=>[s(t,{title:"寄货地址"},{default:d((()=>[(n(),o(y,null,v(x,((e,a)=>s(l,{key:a,label:e[0]},{default:d((()=>[w(b(r(R)[e[1]]),1)])),_:2},1032,["label"]))),64))])),_:1}),s(t,{title:"收货地址"},{default:d((()=>[(n(),o(y,null,v(j,((e,a)=>s(l,{key:a,label:e[0]},{default:d((()=>[w(b(r(R)[e[1]]),1)])),_:2},1032,["label"]))),64))])),_:1}),s(c,{"row-key":"id","data-source":[r(R)],columns:r(S),scroll:{x:"max-content"},pagination:!1},null,8,["data-source","columns"])])),_:1})])),_:1},8,["spinning"])])),_:1},8,["visible"])])}}}),Q={key:0},V={key:0},X=["onClick"],Y=e({__name:"PickList",setup(e){const a=[{type:"input",key:"pick_sn",placeholder:" 请输入上门取件流水号"},{type:"input",key:"sale_sn",placeholder:"请输入售后服务单号"},{type:"input",key:"order_sn",placeholder:" 请输入订单编号"},{type:"input",key:"waybill_code",placeholder:"请输入京东运单号"},{type:"select",key:"third_platform",placeholder:"渠道",options:[{label:"全部",value:0},{label:"快递鸟",value:1},{label:"京东",value:2}]},{type:"select",key:"trace_status",label:"",placeholder:"请选择物流状态",options:[{label:"全部",value:-1},{label:"未签收",value:2},{label:"已签收",value:3},{label:"问题件",value:4}]},{type:"select",key:"status",label:"",placeholder:"请选择上门取件状态",options:[{value:0,label:"待揽件"},{value:1,label:"已揽件"},{value:2,label:"已完成"},{value:3,label:"用户取消"},{value:4,label:"系统取消"},{value:5,label:"已失败"}]},{type:"select",key:"sale_type",label:"",placeholder:"请选择售后类型",options:[{label:"全部",value:-1},{label:"退货",value:1},{label:"换货",value:2}]},{type:"dateRange",key:"created_at_start-created_at_end",placeholder:["申请时间开始","申请时间结束"]},{type:"dateRange",key:"updated_at_start-updated_at_end",placeholder:["更新时间开始","更新时间结束"]},{type:"dateRange",key:"sign_at_start-sign_at_end",placeholder:["签收时间开始","签收时间结束"]},{type:"input",key:"logistics_sn",placeholder:"请输入物流公司"}],l=q([["上门取件流水号","pick_sn"],["售后服务单号","sale_sn"],["订单编号","order_sn"],["商品ID","goods_id"],["商品名称","goods_title"],["售后类型","sale_type_name"],["下单人ID","uid"],["上门取件时间","meet_time_range",120],["物流公司","logistics_name"],["物流单号","logistics_sn"],["重量","weight"],["运费","total_fee"],["退换省心服务抵扣","deduct_fee"],["应付运费","actual_fee"],["申请时间","created_at",120],["更新时间","updated_at",120],["取件状态","status_name"],["签收状态","trace_status_name"],["签收时间","trace_sign_at",120],["渠道","third_platform_name"],["京东运单号","waybill_code"],["操作","operate",180,"right"]]),t=i({handlingId:0,dataSource:[],loading:!1,query:{},pagination:F(),showPickMod:!1,showPickDetail:!1,handlingRow:{},showTransoprt:!1});x((()=>{u()}));const u=()=>{t.loading=!0,p.afterSale.pick.list({page:t.pagination.current,page_size:t.pagination.pageSize,...t.query}).then((e=>{var a;t.loading=!1,t.dataSource=e.data.items,1===t.pagination.current&&(t.pagination.total=+(null==(a=e.data)?void 0:a.count))}))},c=e=>{t.pagination={...t.pagination,...e},u()},g=e=>{t.query=e,t.pagination={...t.pagination,current:1},u()};return(e,i)=>{const h=j("Export"),m=j("Search"),f=I,k=U,v=D,x=S("permission");return n(),o("div",null,[s(m,{"search-options":a,onOnSearch:g},{default:d((()=>[s(h,{api:r(p).afterSale.pick.export,query:r(t).query},null,8,["api","query"])])),_:1}),s(v,{"row-key":"id","data-source":r(t).dataSource,columns:r(l),scroll:{x:"max-content"},loading:r(t).loading,"row-selection":{selectedRowKeys:r(t).selectedRowKeys,onChange(e){r(t).selectedRowKeys=e}},pagination:r(t).pagination,onChange:c},{bodyCell:d((({column:e,record:a})=>["logistics_sn"===e.key?(n(),o("div",Q,[_("div",null,b(a.logistics_sn),1),a.logistics_sn?(n(),o("div",V,[_("a",{href:"javascript:;",type:"link",onClick:e=>{r(t).showTransoprt=!0,r(t).handlingRow=a}}," 查看物流 ",8,X)])):C("",!0)])):C("",!0),"enabled"===e.key?(n(),P(f,{key:1,checked:a.enabled,"onUpdate:checked":e=>a.enabled=e,"un-checked-value":0,"checked-value":1,onChange:e=>(async e=>{await p.product.material.status({id:e.id,enabled:e.enabled}).catch((a=>{e.enabled=0===e.enabled?1:0}))})(a)},null,8,["checked","onUpdate:checked","onChange"])):C("",!0),"operate"===e.key?(n(),o(y,{key:2},[R((n(),P(k,{type:"link",onClick:e=>{r(t).handlingId=a.id,r(t).showPickMod=!0}},{default:d((()=>[w(" 修改 ")])),_:2},1032,["onClick"])),[[x,[r(p).afterSale.pick.mod]]]),R((n(),P(k,{type:"link",onClick:e=>{r(t).handlingId=a.id,r(t).showPickDetail=!0}},{default:d((()=>[w(" 查看详情 ")])),_:2},1032,["onClick"])),[[x,[r(p).afterSale.pick.detail]]])],64)):C("",!0)])),_:1},8,["data-source","columns","loading","row-selection","pagination"]),s(H,{id:r(t).handlingId,show:r(t).showPickMod,"onUpdate:show":i[0]||(i[0]=e=>r(t).showPickMod=e),onFresh:u},null,8,["id","show"]),s($,{id:r(t).handlingId,show:r(t).showPickDetail,"onUpdate:show":i[1]||(i[1]=e=>r(t).showPickDetail=e)},null,8,["id","show"]),s(E,{show:r(t).showTransoprt,"onUpdate:show":i[2]||(i[2]=e=>r(t).showTransoprt=e),row:r(t).handlingRow},null,8,["show","row"])])}}});export{Y as default};
