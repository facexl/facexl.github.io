import{e as a,as as e,d as n,i as l,r as t,m as o,o as i,l as r,a as s,b as u,w as c,f as d,k as p,Z as m,$ as v,M as f,p as g,s as h,F as b,n as _,ca as y,cb as w,cu as k,q as C,I as O,A as j,B as x,E as I,a3 as P,a4 as S,g as U,_ as N,G as D,H as L,x as q}from"./index-c2ae2a0e.js";import{u as A,_ as B}from"./useTableColumns-dd067b4d.js";import"./index-c8577ae4.js";import"./index-3f0a4d2e.js";import{_ as z}from"./index-ef11d20c.js";import{u as E,a as F}from"./useSearchItems-c7d75cf3.js";import{u as M}from"./usePagination-c05046ed.js";import{d as T}from"./index-a09a23de.js";import"./FolderOpenOutlined-fa174baf.js";import"./tool-d986b095.js";import"./RadioButton-bc4165ed.js";const V={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M862 465.3h-81c-4.6 0-9 2-12.1 5.5L550 723.1V160c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v563.1L255.1 470.8c-3-3.5-7.4-5.5-12.1-5.5h-81c-6.8 0-10.5 8.1-6 13.2L487.9 861a31.96 31.96 0 0048.3 0L868 478.5c4.5-5.2.8-13.2-6-13.2z"}}]},name:"arrow-down",theme:"outlined"};function R(a){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?Object(arguments[e]):{},l=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(l=l.concat(Object.getOwnPropertySymbols(n).filter((function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})))),l.forEach((function(e){$(a,e,n[e])}))}return a}function $(a,e,n){return e in a?Object.defineProperty(a,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):a[e]=n,a}var G=function(n,l){var t=R({},n,l.attrs);return a(e,R({},t,{icon:V}),null)};G.displayName="ArrowDownOutlined",G.inheritAttrs=!1;const H=G;const Z={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M868 545.5L536.1 163a31.96 31.96 0 00-48.3 0L156 545.5a7.97 7.97 0 006 13.2h81c4.6 0 9-2 12.1-5.5L474 300.9V864c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V300.9l218.9 252.3c3 3.5 7.4 5.5 12.1 5.5h81c6.8 0 10.5-8 6-13.2z"}}]},name:"arrow-up",theme:"outlined"};function J(a){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?Object(arguments[e]):{},l=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(l=l.concat(Object.getOwnPropertySymbols(n).filter((function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})))),l.forEach((function(e){K(a,e,n[e])}))}return a}function K(a,e,n){return e in a?Object.defineProperty(a,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):a[e]=n,a}var Q=function(n,l){var t=J({},n,l.attrs);return a(e,J({},t,{icon:Z}),null)};Q.displayName="ArrowUpOutlined",Q.inheritAttrs=!1;const W=Q,X=(a=>(P("data-v-c1bfb2ee"),a=a(),S(),a))((()=>U("div",{class:"tips"}," 多个参数用，分割 ",-1))),Y={key:1},aa=N(n({__name:"NewParam",props:{show:Boolean,id:Number},emits:["fresh"],setup(e,{emit:n}){const P=e,S=l(P,"show",n),U=t(),N={required:!0,message:"请输入"},D=o({loading:!1});const L=o({name:"",sort:void 0,params_value:void 0,value_list:[]});i((()=>{})),r(S,(a=>{a&&(U.value&&U.value.resetFields(),P.id&&(D.loading=!0,v.productConfig.param.detail({id:P.id}).then((a=>{for(let e in L)void 0!==a.data[e]&&(L[e]=a.data[e]);setTimeout((a=>{D.loading=!1}),50)}))))}));const q=()=>{L.value_list.push({value:"",id:0})},A=(a,e)=>{let n=L.value_list[a];"up"===e?(L.value_list[a]=L.value_list[a-1],L.value_list[a-1]=n):(L.value_list[a]=L.value_list[a+1],L.value_list[a+1]=n)},B=()=>{U.value.validate().then((async a=>{if(P.id){if(0===a.value_list.length)return m.error("参数不能为空");for(let e=0;e<a.value_list.length;e++)if(!a.value_list[e].value)return m.error("请将参数填写完整")}await v.productConfig.param[P.id?"edit":"add"]({...a,id:P.id||void 0}),S.value=!1,n("fresh")})).catch((a=>{console.log(a)}))};return(n,l)=>{const t=O,o=j,i=x,r=I,m=f;return s(),u("div",null,[a(m,{visible:d(S),"onUpdate:visible":l[3]||(l[3]=a=>p(S)?S.value=a:null),width:"600px",title:e.id?"编辑参数":"添加参数","mask-closable":!1,onOk:B},{default:c((()=>[a(r,{ref_key:"formRef",ref:U,model:d(L),autocomplete:"off","label-col":{span:5},"wrapper-col":{span:18}},{default:c((()=>[a(o,{name:"name",label:"参数组名称",rules:[N]},{default:c((()=>[a(t,{value:d(L).name,"onUpdate:value":l[0]||(l[0]=a=>d(L).name=a),"max-length":30,placeholder:"请输入参数组名称"},null,8,["value"])])),_:1},8,["rules"]),a(o,{name:"sort",label:"排序值",rules:[N]},{default:c((()=>[a(t,{value:d(L).sort,"onUpdate:value":l[1]||(l[1]=a=>d(L).sort=a),placeholder:"请输入排序值"},null,8,["value"])])),_:1},8,["rules"]),e.id?h("",!0):(s(),g(o,{key:0,name:"params_value",label:"参数",rules:[N]},{default:c((()=>[a(t,{value:d(L).params_value,"onUpdate:value":l[2]||(l[2]=a=>d(L).params_value=a),placeholder:"请输入参数"},null,8,["value"]),X])),_:1},8,["rules"])),e.id?(s(),u("div",Y,[(s(!0),u(b,null,_(d(L).value_list||[],((e,n)=>(s(),g(o,{key:n,name:`value_list[${n}]['value']`,label:0===n?"参数":" ",class:w(0===n?"":"no-label-colon")},{default:c((()=>[a(t,{value:e.value,"onUpdate:value":a=>e.value=a,style:{width:"200px"},placeholder:"请输入参数"},null,8,["value","onUpdate:value"]),a(d(y),{class:"btn-icon",onClick:a=>(a=>{L.value_list.splice(a,1)})(n)},null,8,["onClick"]),0!==n?(s(),g(d(W),{key:0,class:"btn-icon",onClick:a=>A(n,"up")},null,8,["onClick"])):h("",!0),n!==d(L).value_list.length-1?(s(),g(d(H),{key:1,class:"btn-icon",onClick:a=>A(n,"donw")},null,8,["onClick"])):h("",!0)])),_:2},1032,["name","label","class"])))),128)),a(o,{label:" ",class:w("no-label-colon")},{default:c((()=>[a(i,{onClick:q},{icon:c((()=>[a(d(k))])),default:c((()=>[C("新增 ")])),_:1})])),_:1}),a(o,{name:"value_list",style:{display:"none"}})])):h("",!0)])),_:1},8,["model"])])),_:1},8,["visible","title"])])}}}),[["__scopeId","data-v-c1bfb2ee"]]),ea={key:1},na=n({__name:"ParamManage",setup(e){const n=E([["input","param_group_name","参数组名称"],["input","param_value_name","参数名称"]]),l=A([["编号","id"],["参数组","name"],["参数名称","param_values"],["排序","sort"],["操作","operate",130,"right"]]),t=o({handlingId:0,dataSource:[],loading:!1,query:{},pagination:M(),showNewDialog:!1,handlingInfo:{}});i((()=>{r()}));const r=()=>{t.loading=!0,v.productConfig.param.list({page:t.pagination.current,page_size:t.pagination.pageSize,...t.query}).then((a=>{var e;t.loading=!1,a.data.items.forEach((a=>{a.param_values=a.param_values.join(",")})),t.dataSource=a.data.items,1===t.pagination.current&&(t.pagination.total=+(null==(e=a.data)?void 0:e.count)),F(n,"status",a.data.enabled_map)}))},p=a=>{t.pagination={...t.pagination,...a},r()},m=a=>{t.query=a,t.pagination={...t.pagination,current:1},r()};return(e,o)=>{const i=x,f=D("Search"),b=z,_=B,y=L("permission");return s(),u("div",null,[a(f,{"search-options":d(n),onOnSearch:m},{default:c((()=>[q((s(),g(i,{type:"primary",onClick:o[0]||(o[0]=a=>{d(t).handlingId=0,d(t).handlingInfo={},d(t).showNewDialog=!0})},{default:c((()=>[C(" 添加 ")])),_:1})),[[y,[d(v).productConfig.param.add]]])])),_:1},8,["search-options"]),a(_,{"data-source":d(t).dataSource,columns:d(l),scroll:{x:"max-content"},loading:d(t).loading,pagination:d(t).pagination,onChange:p},{bodyCell:c((({column:a,record:e})=>["enabled"===a.key?(s(),g(b,{key:0,checked:e.enabled,"onUpdate:checked":a=>e.enabled=a,"un-checked-value":0,"checked-value":1,onChange:a=>(async a=>{await v.productConfig.param.status({id:a.id}).catch((e=>{a.enabled=1===a.enabled?0:1}))})(e)},null,8,["checked","onUpdate:checked","onChange"])):h("",!0),"operate"===a.key?(s(),u("div",ea,[q((s(),g(i,{type:"link",onClick:a=>{d(t).handlingId=e.id,d(t).handlingInfo=e,d(t).showNewDialog=!0}},{default:c((()=>[C(" 编辑 ")])),_:2},1032,["onClick"])),[[y,[d(v).productConfig.param.edit]]]),q((s(),g(i,{type:"link",class:"danger-color",onClick:a=>{return n=e.id,void T.confirm({title:"提示",content:"确认删除该参数？",okText:"确认",cancelText:"取消",onOk:()=>{v.productConfig.param.delete({id:n}).then((a=>{r()}))}});var n}},{default:c((()=>[C(" 删除 ")])),_:2},1032,["onClick"])),[[y,[d(v).productConfig.param.delete]]])])):h("",!0)])),_:1},8,["data-source","columns","loading","pagination"]),a(aa,{id:d(t).handlingId,show:d(t).showNewDialog,"onUpdate:show":o[1]||(o[1]=a=>d(t).showNewDialog=a),"handling-info":d(t).handlingInfo,onFresh:r},null,8,["id","show","handling-info"])])}}});export{na as default};
