import{d as e,i as a,r as n,m as l,o,l as t,a as i,b as s,e as d,w as u,f as r,k as c,$ as p,M as m,q as g,I as h,A as f,E as v,_ as b,G as _,H as y,x as k,p as w,s as C,B as x}from"./index-c2ae2a0e.js";import{u as I,_ as j}from"./useTableColumns-dd067b4d.js";import{R as U,_ as N}from"./index-c8577ae4.js";import"./index-3f0a4d2e.js";import{_ as S}from"./index-ef11d20c.js";import{u as q,a as D}from"./useSearchItems-c7d75cf3.js";import{u as O}from"./usePagination-c05046ed.js";import{_ as T}from"./index-8036da2a.js";import{d as B}from"./index-a09a23de.js";import"./FolderOpenOutlined-fa174baf.js";import"./tool-d986b095.js";import"./RadioButton-bc4165ed.js";const F=b(e({__name:"NewLogisticsCompany",props:{show:Boolean,id:Number,handlingInfo:{type:Object,default:()=>{}}},emits:["fresh"],setup(e,{emit:b}){const _=e,y=a(_,"show",b),k=n(),w={required:!0,message:"请输入"},C=l({loading:!1}),x=l({name:"",code:void 0,tel:void 0,enabled:0});o((()=>{})),t(y,(e=>{e&&(k.value&&k.value.resetFields(),_.id&&(C.loading=!0,setTimeout((e=>{for(let a in x)void 0!==_.handlingInfo[a]&&(x[a]=_.handlingInfo[a])}),200)))}));const I=()=>{k.value.validate().then((async e=>{await p.set.logisticsCompany[_.id?"edit":"add"]({...e,id:_.id||void 0}),y.value=!1,b("fresh")})).catch((e=>{console.log(e)}))};return(a,n)=>{const l=h,o=f,t=T,p=U,b=N,_=v,C=m;return i(),s("div",null,[d(C,{visible:r(y),"onUpdate:visible":n[4]||(n[4]=e=>c(y)?y.value=e:null),width:"600px",title:e.id?"编辑物流公司":"添加物流公司","mask-closable":!1,onOk:I},{default:u((()=>[d(_,{ref_key:"formRef",ref:k,model:r(x),autocomplete:"off","label-col":{span:5},"wrapper-col":{span:18}},{default:u((()=>[d(o,{name:"name",label:"快递名称",rules:[w]},{default:u((()=>[d(l,{value:r(x).name,"onUpdate:value":n[0]||(n[0]=e=>r(x).name=e),maxlength:30,placeholder:"请输入快递名称"},null,8,["value"])])),_:1},8,["rules"]),d(o,{name:"code",label:"快递代码",rules:[w]},{default:u((()=>[d(l,{value:r(x).code,"onUpdate:value":n[1]||(n[1]=e=>r(x).code=e),maxlength:30,placeholder:"请输入快递代码"},null,8,["value"])])),_:1},8,["rules"]),d(o,{name:"tel",label:"联系电话"},{default:u((()=>[d(t,{value:r(x).tel,"onUpdate:value":n[2]||(n[2]=e=>r(x).tel=e),maxlength:15,placeholder:"请输入赔付金额"},null,8,["value"])])),_:1}),d(o,{name:"enabled",label:"是否启用"},{default:u((()=>[d(b,{value:r(x).enabled,"onUpdate:value":n[3]||(n[3]=e=>r(x).enabled=e)},{default:u((()=>[d(p,{value:1},{default:u((()=>[g(" 是 ")])),_:1}),d(p,{value:0},{default:u((()=>[g(" 否 ")])),_:1})])),_:1},8,["value"])])),_:1})])),_:1},8,["model"])])),_:1},8,["visible","title"])])}}}),[["__scopeId","data-v-81b6cbbd"]]),R={key:1},z=e({__name:"LogisticsCompany",setup(e){const a=q([["input","id","快递ID"],["input","keywords","关键词"],["select","enabled","状态"]]),n=I([["编号","id"],["快递名称","name"],["快递代码","code"],["联系电话","tel"],["状态","enabled"],["更新时间","updated_at"],["操作","operate",130,"right"]]),t=l({handlingId:0,dataSource:[],loading:!1,query:{},pagination:O(),showNewDialog:!1,handlingInfo:{}});o((()=>{c()}));const c=()=>{t.loading=!0,p.set.logisticsCompany.list({page:t.pagination.current,page_size:t.pagination.pageSize,...t.query}).then((e=>{var n;t.loading=!1,t.dataSource=e.data.items,1===t.pagination.current&&(t.pagination.total=+(null==(n=e.data)?void 0:n.count)),D(a,"enabled",e.data.enabled_status_map)}))},m=e=>{t.pagination={...t.pagination,...e},c()},h=e=>{t.query=e,t.pagination={...t.pagination,current:1},c()};return(e,l)=>{const o=x,f=_("Search"),v=S,b=j,I=y("permission");return i(),s("div",null,[d(f,{"search-options":r(a),onOnSearch:h},{default:u((()=>[k((i(),w(o,{type:"primary",onClick:l[0]||(l[0]=e=>{r(t).handlingId=0,r(t).handlingInfo={},r(t).showNewDialog=!0})},{default:u((()=>[g(" 添加 ")])),_:1})),[[I,[r(p).set.logisticsCompany.add]]])])),_:1},8,["search-options"]),d(b,{"data-source":r(t).dataSource,columns:r(n),scroll:{x:"max-content"},loading:r(t).loading,pagination:r(t).pagination,onChange:m},{bodyCell:u((({column:e,record:a})=>["enabled"===e.key?(i(),w(v,{key:0,checked:a.enabled,"onUpdate:checked":e=>a.enabled=e,"un-checked-value":0,"checked-value":1,onChange:e=>(async e=>{await p.set.logisticsCompany.status({id:e.id,enabled:e.enabled}).catch((a=>{e.enabled=1===e.enabled?0:1}))})(a)},null,8,["checked","onUpdate:checked","onChange"])):C("",!0),"operate"===e.key?(i(),s("div",R,[k((i(),w(o,{type:"link",onClick:e=>{r(t).handlingId=a.id,r(t).handlingInfo=a,r(t).showNewDialog=!0}},{default:u((()=>[g(" 编辑 ")])),_:2},1032,["onClick"])),[[I,[r(p).set.logisticsCompany.edit]]]),k((i(),w(o,{type:"link",class:"danger-color",onClick:e=>{return n=a,void B.confirm({title:"提示",content:"确认删除该物流公司？",okText:"确认",cancelText:"取消",onOk:()=>{p.set.logisticsCompany.delete({ids:n.id+""}).then((e=>{c()}))}});var n}},{default:u((()=>[g(" 删除 ")])),_:2},1032,["onClick"])),[[I,[r(p).set.logisticsCompany.delete]]])])):C("",!0)])),_:1},8,["data-source","columns","loading","pagination"]),d(F,{id:r(t).handlingId,show:r(t).showNewDialog,"onUpdate:show":l[1]||(l[1]=e=>r(t).showNewDialog=e),"handling-info":r(t).handlingInfo,onFresh:c},null,8,["id","show","handling-info"])])}}});export{z as default};
